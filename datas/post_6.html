<h2>起因</h2>
<p>最近在用Z-library，下载了一些epub电子书，用Neat Reader看，Neat Reader好是好，但是一些自定义样式要VIP。</p>
<p>但我可是有着从未在网络上用一分钱购买任何虚拟产品的纪录的，于是我就想，我可不可以自己做一个epub解析器</p>
<h2>思路</h2>
<p>我从Z-library下载的epub电子书是application/epub+zip格式，首先我需要把它解压，目录大概是这样：</p>
<pre><code>images/
- 00001.jpeg
- 00002.jpeg
- ...
META-INF/
- container.xml
text/
- part0001.html
- part0002.html
- ...
content.opf
cover.jpeg
mimetype
page_styles.css
stylesheet.css
titlepage.xhtml
toc.ncx
</code></pre><p>epub的所有资源的索引就在content.opf(xml)里，同时也包括这本电子书的名字、作者、出版社、封面等信息</p>
<p>toc.ncx(xml)放的是目录</p>
<p>文字内容是html的形式，正好方便了解析查看。</p>
<p>所以我们只需解压epub然后读取content.opf建立文件索引，然后读取toc.ncx目录，之后再渲染到网页上就可以了。</p>
<h2>实现</h2>
<h3>解压</h3>
<p>解压我用的是zip.js</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> epubblob=inputfile.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];
<span class="hljs-keyword">var</span> reader=<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">ZipReader</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">BlobReader</span>(epubblob));
<span class="hljs-keyword">var</span> entries = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">getEntries</span>()
<span class="hljs-comment">/*
[
  {
    filename:&quot;dir/file&quot;,
    getData:Function
  }
]
 */</span>
</code></pre><h3>解析 content.opf</h3>
<pre><code class="hljs language-javascript">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getFile</span>(<span class="hljs-params">entries,path</span>){
      <span class="hljs-keyword">return</span> entries.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>){
            <span class="hljs-keyword">return</span> entry.<span class="hljs-property">filename</span>==path
        })
  }

  <span class="hljs-keyword">var</span> xml=<span class="hljs-keyword">await</span> <span class="hljs-title function_">getFile</span>(entries,<span class="hljs-string">&#x27;content.opf&#x27;</span>).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());
  <span class="hljs-keyword">var</span> domparser=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>();
  <span class="hljs-keyword">var</span> doc=domparser.<span class="hljs-title function_">parseFromString</span>(xml,<span class="hljs-string">&#x27;text/html&#x27;</span>);
  doc=doc.<span class="hljs-property">documentElement</span>;

  <span class="hljs-comment">// 标题</span>
  <span class="hljs-keyword">var</span> title=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:title&#x27;</span>).<span class="hljs-property">textContent</span>;

  <span class="hljs-comment">// 作者</span>
  <span class="hljs-keyword">var</span> writer=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:creator&#x27;</span>).<span class="hljs-property">textContent</span>;

  <span class="hljs-comment">// 发行日期</span>
  <span class="hljs-keyword">var</span> date=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:date&#x27;</span>).<span class="hljs-property">textContent</span>;

  <span class="hljs-comment">// 出版社</span>
  <span class="hljs-keyword">var</span> publisher=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:publisher&#x27;</span>).<span class="hljs-property">textContent</span>;

  <span class="hljs-comment">// 语言</span>
  <span class="hljs-keyword">var</span> lang=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:language&#x27;</span>).<span class="hljs-property">textContent</span>;

  <span class="hljs-comment">// 文件索引</span>
  <span class="hljs-keyword">var</span> items=doc.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;manifest item&#x27;</span>);
  <span class="hljs-keyword">var</span> itemObj={};
  <span class="hljs-keyword">var</span> cover,titlepage;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;items.<span class="hljs-property">length</span>;i++){
      <span class="hljs-keyword">var</span> item=items[i];
      <span class="hljs-keyword">if</span>(!item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)){
          <span class="hljs-keyword">return</span> ;
      }
      <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>)==<span class="hljs-string">&#x27;cover&#x27;</span>){
          cover=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>);
      }
      <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>)==<span class="hljs-string">&#x27;titlepage&#x27;</span>){
          titlepage=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>);
      }
      <span class="hljs-comment">// 判断图片</span>
      <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.jpg&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.png&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.gif&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.jpeg&#x27;</span>)){
          itemObj[item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)]=<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getFile</span>(entries,item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">BlobWriter</span>()));
      }<span class="hljs-keyword">else</span>{
          itemObj[item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)]=<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getFile</span>(entries,item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());
      }
  }
  
  <span class="hljs-keyword">let</span> epubData={
      <span class="hljs-attr">title</span>:title,
      <span class="hljs-attr">writer</span>:writer,
      <span class="hljs-attr">date</span>:date,
      <span class="hljs-attr">publisher</span>:publisher,
      <span class="hljs-attr">lang</span>:lang,
      <span class="hljs-attr">itemObj</span>:itemObj,
      <span class="hljs-attr">cover</span>:itemObj[cover],
      <span class="hljs-attr">titlepage</span>:titlepage
  };
</code></pre><h3>解析toc.ncx</h3>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> xml=<span class="hljs-keyword">await</span> entries.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>){
    <span class="hljs-keyword">return</span> entry.<span class="hljs-property">filename</span>==<span class="hljs-string">&#x27;toc.ncx&#x27;</span>;
}).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());

<span class="hljs-keyword">var</span> doc=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>().<span class="hljs-title function_">parseFromString</span>(xml,<span class="hljs-string">&#x27;text/html&#x27;</span>);<span class="hljs-comment">// 用text/html更方便</span>
<span class="hljs-keyword">var</span> navmap=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;navmap&#x27;</span>);

<span class="hljs-comment">// 遍历目录</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">items</span>){
    <span class="hljs-keyword">var</span> toc=[];
    items.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>){
        <span class="hljs-keyword">if</span>(item.<span class="hljs-property">nodeType</span>==<span class="hljs-number">1</span>){
            <span class="hljs-keyword">var</span> a={};
            <span class="hljs-keyword">var</span> childNodes=item.<span class="hljs-property">childNodes</span>;
            childNodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>){
                <span class="hljs-keyword">if</span>(item.<span class="hljs-property">nodeType</span>==<span class="hljs-number">1</span>){
                    <span class="hljs-keyword">if</span>(item.<span class="hljs-property">tagName</span>==<span class="hljs-string">&#x27;NAVLABEL&#x27;</span>){
                      <span class="hljs-comment">//标题</span>
                        a.<span class="hljs-property">label</span>=item.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();
                    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(item.<span class="hljs-property">tagName</span>==<span class="hljs-string">&#x27;CONTENT&#x27;</span>){
                        <span class="hljs-keyword">var</span> href=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                        <span class="hljs-comment">//索引</span>
                        a.<span class="hljs-property">href</span>=href[<span class="hljs-number">0</span>];

                        href.<span class="hljs-title function_">shift</span>();
                        <span class="hljs-comment">// 定位</span>
                        a.<span class="hljs-property">hash</span>=href.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                        <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;NAVPOINT&#x27;</span>)){
                            a.<span class="hljs-property">list</span>=<span class="hljs-title function_">g</span>(item.<span class="hljs-property">childNodes</span>);<span class="hljs-comment">//遍历子目录</span>
                        }
                    }
                } 
            });
            toc.<span class="hljs-title function_">push</span>(a);
        }                
      })
      <span class="hljs-keyword">return</span> toc;
}

epubData.<span class="hljs-property">toc</span>=<span class="hljs-title function_">g</span>(navmap.<span class="hljs-property">childNodes</span>);
</code></pre><h3>渲染</h3>
<p>做一个container</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> epubContainer=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
epubContainer.<span class="hljs-property">className</span>=<span class="hljs-string">&#x27;epub-container&#x27;</span>;
epubContainer.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">&#x27;&lt;div class=&quot;epub-toc&quot;&gt;&lt;div class=&quot;epub-toc-list&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;epub-content&quot;&gt;&lt;/div&gt;&#x27;</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(epubContainer);
</code></pre><p>渲染目录</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">gtoc</span>(<span class="hljs-params">n,r</span>){
  r.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
      <span class="hljs-keyword">var</span> a=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
      a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;epub-toc-item&#x27;</span>);
      a.<span class="hljs-property">innerText</span>=e.<span class="hljs-property">label</span>;
      a.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-href&#x27;</span>,e.<span class="hljs-property">href</span>);
      a.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-hash&#x27;</span>,e.<span class="hljs-property">hash</span>);
      n.<span class="hljs-title function_">appendChild</span>(a);
      a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
          <span class="hljs-keyword">var</span> t=a.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-href&#x27;</span>);
          <span class="hljs-keyword">var</span> i=a.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-hash&#x27;</span>);
          epubContainer.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.epub-toc-item&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>){
              a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;active&#x27;</span>);
          })
          a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;active&#x27;</span>);
          <span class="hljs-title function_">view</span>(t,i) <span class="hljs-comment">// 见下方</span>
      });
      <span class="hljs-keyword">if</span>(e.<span class="hljs-property">list</span>){
          <span class="hljs-keyword">var</span> b=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
          b.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;epub-toc-list&#x27;</span>);
          n.<span class="hljs-title function_">appendChild</span>(b);
          <span class="hljs-title function_">gtoc</span>(b,e.<span class="hljs-property">list</span>); <span class="hljs-comment">// 渲染子目录</span>
      }
  })
}
<span class="hljs-comment">// 遍历渲染目录</span>
<span class="hljs-title function_">gtoc</span>(epubContainer.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.epub-toc-list&#x27;</span>),epubData.<span class="hljs-property">toc</span>);
</code></pre><p>渲染内容</p>
<pre><code class="hljs language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>=<span class="hljs-literal">null</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">t,i</span>){
  <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>!=t){
      <span class="hljs-keyword">var</span> html=epubData.<span class="hljs-property">itemObj</span>[t];
      <span class="hljs-keyword">var</span> d=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>().<span class="hljs-title function_">parseFromString</span>(html,<span class="hljs-string">&#x27;text/html&#x27;</span>);
      <span class="hljs-comment">// 获取所有图片并根据索引替换成对应已解析数据</span>
      d.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;img&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
          e.<span class="hljs-property">src</span>=epubData.<span class="hljs-property">itemObj</span>[e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)];  
      });
      <span class="hljs-comment">// 获取所有样式并添加到网页</span>
      d.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;link[rel=stylesheet]&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
          <span class="hljs-keyword">var</span> s=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);
          s.<span class="hljs-property">innerHTML</span>=epubData.<span class="hljs-property">itemObj</span>[e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)];
          <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(s);
      });
      
      <span class="hljs-comment">//获取标题</span>
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span>=d.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;title&#x27;</span>).<span class="hljs-property">innerText</span>;

      <span class="hljs-comment">// 填充内容</span>
      o.<span class="hljs-property">innerHTML</span>=d.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span>;
      o.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;a&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
          e.<span class="hljs-property">onclick</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>){
              ev.<span class="hljs-title function_">preventDefault</span>();
              <span class="hljs-comment">// 渲染锚点链接</span>
              <span class="hljs-keyword">var</span> h=e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
              h.<span class="hljs-title function_">shift</span>();
              <span class="hljs-keyword">var</span> i=h.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
              <span class="hljs-keyword">try</span> {
                  o.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#&#x27;</span>+i).<span class="hljs-title function_">scrollIntoView</span>();
              } <span class="hljs-keyword">catch</span> (error) {
                  
              }
          }
      });
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>=t;
  }
  <span class="hljs-keyword">try</span> {
      o.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#&#x27;</span>+i).<span class="hljs-title function_">scrollIntoView</span>();
  } <span class="hljs-keyword">catch</span> (error) {
      
  }
}
<span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span>=epubData.<span class="hljs-property">title</span>;
o.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">`&lt;div class=&quot;epub_info_show&quot;&gt;
  &lt;img src=&quot;<span class="hljs-subst">${epubData.cover}</span>&quot;/&gt;
  &lt;p class=&quot;title&quot;&gt;<span class="hljs-subst">${epubData.title}</span>&lt;/p&gt;
  &lt;p class=&quot;writer&quot;&gt;<span class="hljs-subst">${epubData.writer}</span>&lt;/p&gt;
  &lt;p class=&quot;publisher&quot;&gt;<span class="hljs-subst">${epubData.publisher}</span>&lt;/p&gt;
&lt;/div&gt;`</span>
</code></pre><h2>封装</h2>
<p>把所有代码封装到一起：</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> epubjs = {
    <span class="hljs-attr">view</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>){
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>=<span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> epubContainer=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
        epubContainer.<span class="hljs-property">className</span>=<span class="hljs-string">&#x27;epub-container&#x27;</span>;
        epubContainer.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">&#x27;&lt;div class=&quot;epub-toc&quot;&gt;&lt;div class=&quot;epub-toc-list&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;epub-content&quot;&gt;&lt;/div&gt;&#x27;</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(epubContainer);
        <span class="hljs-keyword">var</span> o=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.epub-content&#x27;</span>);
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">gtoc</span>(<span class="hljs-params">n,r</span>){
            r.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
                <span class="hljs-keyword">var</span> a=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
                a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;epub-toc-item&#x27;</span>);
                a.<span class="hljs-property">innerText</span>=e.<span class="hljs-property">label</span>;
                a.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-href&#x27;</span>,e.<span class="hljs-property">href</span>);
                a.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-hash&#x27;</span>,e.<span class="hljs-property">hash</span>);
                n.<span class="hljs-title function_">appendChild</span>(a);
                a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){
                    <span class="hljs-keyword">var</span> t=a.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-href&#x27;</span>);
                    <span class="hljs-keyword">var</span> i=a.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-hash&#x27;</span>);
                    epubContainer.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.epub-toc-item&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>){
                        a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;active&#x27;</span>);
                    })
                    a.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;active&#x27;</span>);
                    <span class="hljs-title function_">view</span>(t,i)
                });
                <span class="hljs-keyword">if</span>(e.<span class="hljs-property">list</span>){
                    <span class="hljs-keyword">var</span> b=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
                    b.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;epub-toc-list&#x27;</span>);
                    n.<span class="hljs-title function_">appendChild</span>(b);
                    <span class="hljs-title function_">gtoc</span>(b,e.<span class="hljs-property">list</span>);
                }
            })
        }
        <span class="hljs-title function_">gtoc</span>(epubContainer.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.epub-toc-list&#x27;</span>),res.<span class="hljs-property">toc</span>);
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">t,i</span>){
            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>!=t){
                <span class="hljs-keyword">var</span> html=res.<span class="hljs-property">itemObj</span>[t];
                <span class="hljs-keyword">var</span> d=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>().<span class="hljs-title function_">parseFromString</span>(html,<span class="hljs-string">&#x27;text/html&#x27;</span>);
                d.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;img&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
                    e.<span class="hljs-property">src</span>=res.<span class="hljs-property">itemObj</span>[e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)];  
                });
                d.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;link[rel=stylesheet]&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
                    <span class="hljs-keyword">var</span> s=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);
                    s.<span class="hljs-property">innerHTML</span>=res.<span class="hljs-property">itemObj</span>[e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)];
                    <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(s);
                });
                
                <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span>=d.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;title&#x27;</span>).<span class="hljs-property">innerText</span>;
                o.<span class="hljs-property">innerHTML</span>=d.<span class="hljs-property">body</span>.<span class="hljs-property">innerHTML</span>;
                o.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;a&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
                    e.<span class="hljs-property">onclick</span>=<span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>){
                        ev.<span class="hljs-title function_">preventDefault</span>();
                        <span class="hljs-keyword">var</span> h=e.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                        h.<span class="hljs-title function_">shift</span>();
                        <span class="hljs-keyword">var</span> i=h.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                        <span class="hljs-keyword">try</span> {
                            o.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#&#x27;</span>+i).<span class="hljs-title function_">scrollIntoView</span>();
                        } <span class="hljs-keyword">catch</span> (error) {
                            
                        }
                    }
                });
                <span class="hljs-variable language_">window</span>.<span class="hljs-property">epubNowShow</span>=t;
            }
            <span class="hljs-keyword">try</span> {
                o.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#&#x27;</span>+i).<span class="hljs-title function_">scrollIntoView</span>();
            } <span class="hljs-keyword">catch</span> (error) {
                
            }
        }
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span>=res.<span class="hljs-property">title</span>;
        o.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">`&lt;div class=&quot;epub_info_show&quot;&gt;
            &lt;img src=&quot;<span class="hljs-subst">${res.cover}</span>&quot;/&gt;
            &lt;p class=&quot;title&quot;&gt;<span class="hljs-subst">${res.title}</span>&lt;/p&gt;
            &lt;p class=&quot;writer&quot;&gt;<span class="hljs-subst">${res.writer}</span>&lt;/p&gt;
            &lt;p class=&quot;publisher&quot;&gt;<span class="hljs-subst">${res.publisher}</span>&lt;/p&gt;
        &lt;/div&gt;`</span>
    },
    <span class="hljs-attr">parse</span>:<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>) {
        <span class="hljs-keyword">var</span> readerm;
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> path==<span class="hljs-string">&#x27;string&#x27;</span>){
            readerm = <span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">HttpReader</span>(path);
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(path <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Blob</span>){
            readerm = <span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">BlobReader</span>(path);
        }
        <span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">ZipReader</span>(readerm);
        <span class="hljs-keyword">var</span> entries = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">getEntries</span>()
        <span class="hljs-keyword">var</span> contentOpf=<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getContentOpf</span>(entries);
        <span class="hljs-keyword">var</span> toc=<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getToc</span>(entries);
        contentOpf.<span class="hljs-property">toc</span>=toc;
        <span class="hljs-keyword">return</span> contentOpf
    },
    <span class="hljs-attr">getContentOpf</span>:<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">entries</span>){
        <span class="hljs-keyword">var</span> xml=<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getFile</span>(entries,<span class="hljs-string">&#x27;content.opf&#x27;</span>).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());
        <span class="hljs-keyword">var</span> domparser=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>();
        <span class="hljs-keyword">var</span> doc=domparser.<span class="hljs-title function_">parseFromString</span>(xml,<span class="hljs-string">&#x27;text/html&#x27;</span>);
        doc=doc.<span class="hljs-property">documentElement</span>;
        <span class="hljs-keyword">var</span> title=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:title&#x27;</span>).<span class="hljs-property">textContent</span>;
        <span class="hljs-keyword">var</span> writer=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:creator&#x27;</span>).<span class="hljs-property">textContent</span>;
        <span class="hljs-keyword">var</span> date=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:date&#x27;</span>).<span class="hljs-property">textContent</span>;
        <span class="hljs-keyword">var</span> publisher=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:publisher&#x27;</span>).<span class="hljs-property">textContent</span>;
        <span class="hljs-keyword">var</span> lang=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;dc\\:language&#x27;</span>).<span class="hljs-property">textContent</span>;
        <span class="hljs-keyword">var</span> items=doc.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;manifest item&#x27;</span>);
        <span class="hljs-keyword">var</span> itemObj={};
        <span class="hljs-keyword">var</span> cover,titlepage;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;items.<span class="hljs-property">length</span>;i++){
            <span class="hljs-keyword">var</span> item=items[i];
            <span class="hljs-keyword">if</span>(!item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)){
                <span class="hljs-keyword">return</span> ;
            }
            <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>)==<span class="hljs-string">&#x27;cover&#x27;</span>){
                cover=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>);
            }
            <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>)==<span class="hljs-string">&#x27;titlepage&#x27;</span>){
                titlepage=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>);
            }
            <span class="hljs-comment">// 判断图片</span>
            <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.jpg&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.png&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.gif&#x27;</span>)||item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.jpeg&#x27;</span>)){
                itemObj[item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)]=<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getFile</span>(entries,item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">BlobWriter</span>()));
            }<span class="hljs-keyword">else</span>{
                itemObj[item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)]=<span class="hljs-keyword">await</span> epubjs.<span class="hljs-title function_">getFile</span>(entries,item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;href&#x27;</span>)).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());
            }
        }
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">title</span>:title,
            <span class="hljs-attr">writer</span>:writer,
            <span class="hljs-attr">date</span>:date,
            <span class="hljs-attr">publisher</span>:publisher,
            <span class="hljs-attr">lang</span>:lang,
            <span class="hljs-attr">itemObj</span>:itemObj,
            <span class="hljs-attr">cover</span>:itemObj[cover],
            <span class="hljs-attr">titlepage</span>:titlepage
        };
    },
    <span class="hljs-attr">getToc</span>:<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">entries</span>){
        <span class="hljs-keyword">var</span> xml=<span class="hljs-keyword">await</span> entries.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>){
            <span class="hljs-keyword">return</span> entry.<span class="hljs-property">filename</span>==<span class="hljs-string">&#x27;toc.ncx&#x27;</span>;
        }).<span class="hljs-title function_">getData</span>(<span class="hljs-keyword">new</span> zip.<span class="hljs-title class_">TextWriter</span>());
        <span class="hljs-keyword">var</span> doc=<span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>().<span class="hljs-title function_">parseFromString</span>(xml,<span class="hljs-string">&#x27;text/html&#x27;</span>);
        <span class="hljs-keyword">var</span> navmap=doc.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;navmap&#x27;</span>);
        <span class="hljs-keyword">var</span> toc=<span class="hljs-title function_">g</span>(navmap.<span class="hljs-property">childNodes</span>);
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">items</span>){
            <span class="hljs-keyword">var</span> toc=[];
            items.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>){
                <span class="hljs-keyword">if</span>(item.<span class="hljs-property">nodeType</span>==<span class="hljs-number">1</span>){
                    <span class="hljs-keyword">var</span> a={};
                    <span class="hljs-keyword">var</span> childNodes=item.<span class="hljs-property">childNodes</span>;
                    childNodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>){
                        <span class="hljs-keyword">if</span>(item.<span class="hljs-property">nodeType</span>==<span class="hljs-number">1</span>){
                            <span class="hljs-keyword">if</span>(item.<span class="hljs-property">tagName</span>==<span class="hljs-string">&#x27;NAVLABEL&#x27;</span>){
                                a.<span class="hljs-property">label</span>=item.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>();
                            }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(item.<span class="hljs-property">tagName</span>==<span class="hljs-string">&#x27;CONTENT&#x27;</span>){
                                <span class="hljs-keyword">var</span> href=item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                                a.<span class="hljs-property">href</span>=href[<span class="hljs-number">0</span>];
                                href.<span class="hljs-title function_">shift</span>();
                                a.<span class="hljs-property">hash</span>=href.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;#&#x27;</span>);
                                <span class="hljs-keyword">if</span>(item.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;NAVPOINT&#x27;</span>)){
                                    a.<span class="hljs-property">list</span>=<span class="hljs-title function_">g</span>(item.<span class="hljs-property">childNodes</span>);
                                }
                            }
                        } 
                    });
                    toc.<span class="hljs-title function_">push</span>(a);
                }                
             })
             <span class="hljs-keyword">return</span> toc;
        }
        <span class="hljs-keyword">return</span> toc;
    },
    <span class="hljs-attr">getFile</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">entries,path</span>){
        <span class="hljs-keyword">return</span> entries.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">entry</span>){
            <span class="hljs-keyword">return</span> entry.<span class="hljs-property">filename</span>==path
        })
    },
    <span class="hljs-attr">show</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">path</span>){
        epubjs.<span class="hljs-title function_">parse</span>(path).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>){
            epubjs.<span class="hljs-title function_">view</span>(res);
        })
    }
}
</code></pre><p>再写一下CSS:</p>
<pre><code class="hljs language-css"><span class="hljs-selector-tag">body</span>{
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-class">.epub-container</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">overflow</span>: hidden;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
    <span class="hljs-attribute">box-sizing</span>: border-box;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">overflow</span>:auto;
    <span class="hljs-attribute">float</span>: left;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span> <span class="hljs-selector-class">.epub-toc-list</span>{
    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">1em</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span>&gt;<span class="hljs-selector-class">.epub-toc-list</span>{
    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span> <span class="hljs-selector-class">.epub-toc-item</span>{
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span> <span class="hljs-number">3px</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">2px</span> <span class="hljs-number">0</span>;
    <span class="hljs-attribute">cursor</span>: pointer;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">5px</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span> <span class="hljs-selector-class">.epub-toc-item</span><span class="hljs-selector-pseudo">:hover</span>{
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f5f5f5</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-toc</span> <span class="hljs-selector-class">.epub-toc-item</span><span class="hljs-selector-class">.active</span>{
    <span class="hljs-attribute">font-weight</span>: bold;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">300px</span>);
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">overflow</span>: auto;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
    <span class="hljs-attribute">box-sizing</span>: border-box;
    <span class="hljs-attribute">float</span>: left;
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.5em</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span> <span class="hljs-selector-class">.epub_info_show</span> <span class="hljs-selector-tag">img</span>{
    <span class="hljs-attribute">width</span>:<span class="hljs-number">260px</span>;
    <span class="hljs-attribute">display</span>: block;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> auto;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span> <span class="hljs-selector-class">.epub_info_show</span> <span class="hljs-selector-tag">p</span>{
    <span class="hljs-attribute">text-align</span>: center;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span> <span class="hljs-selector-class">.epub_info_show</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.title</span>{
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span> <span class="hljs-selector-class">.epub_info_show</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.writer</span>{
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
}
<span class="hljs-selector-class">.epub-container</span> <span class="hljs-selector-class">.epub-content</span> <span class="hljs-selector-class">.epub_info_show</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.publisher</span>{
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#aaa</span>;
}
</code></pre><p>大功告成！</p>
<p><img src="https://s21.ax1x.com/2024/03/23/pFhfPAS.png" alt="pFhfPAS.png">
<img src="https://s21.ax1x.com/2024/03/23/pFhfFhQ.png" alt="pFhfFhQ.png"></p>
<h2>总结</h2>
<p>也没有想象中那么难，至少基本的是做出来了，后面就慢慢优化样式吧。</p>
